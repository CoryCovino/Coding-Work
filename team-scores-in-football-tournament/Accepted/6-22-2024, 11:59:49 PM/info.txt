{"id":1297362564,"question_id":1339,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719115189,"status":10,"status_display":"Accepted","runtime":"659 ms","url":"/submissions/detail/1297362564/","is_pending":"Not Pending","title":"Team Scores in Football Tournament","memory":"0B","code":"# Write your MySQL query statement below\nWITH combined_totals AS (\n    SELECT host_team AS team\n        , SUM(CASE WHEN host_goals > guest_goals\n                THEN 3\n                WHEN host_goals = guest_goals\n                THEN 1\n                ELSE 0\n                    END) AS points\n    FROM Matches\n    GROUP BY host_team\n\n    UNION ALL\n\n    SELECT guest_team\n        , SUM(CASE WHEN guest_goals > host_goals\n                THEN 3\n                WHEN guest_goals = host_goals\n                THEN 1\n                ELSE 0\n                    END) AS guest_points\n    FROM Matches\n    GROUP BY guest_team\n)\n\nSELECT t.team_id\n    , t.team_name\n    , IFNULL(SUM(c.points), 0) AS num_points\nFROM Teams t\nLEFT OUTER JOIN combined_totals c ON c.team = t.team_id\nGROUP BY t.team_id\n    , t.team_name\nORDER BY IFNULL(SUM(c.points), 0) DESC, t.team_id;\n","compare_result":"11111111111111111","title_slug":"team-scores-in-football-tournament","has_notes":false,"flag_type":1}
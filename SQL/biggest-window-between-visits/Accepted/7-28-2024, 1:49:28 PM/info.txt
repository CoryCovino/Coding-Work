{"id":1336503183,"question_id":1852,"lang":"mysql","lang_name":"MySQL","time":"4 months, 2 weeks","timestamp":1722188968,"status":10,"status_display":"Accepted","runtime":"644 ms","url":"/submissions/detail/1336503183/","is_pending":"Not Pending","title":"Biggest Window Between Visits","memory":"0B","code":"SELECT user_id\n    , MAX(diff) AS biggest_window\nFROM (\n    SELECT user_id\n        , visit_date\n        , LEAD(visit_date, 1) OVER (PARTITION BY user_id ORDER BY visit_date) AS next_visit_date\n        , DATEDIFF(IFNULL(LEAD(visit_date, 1) OVER (PARTITION BY user_id ORDER BY visit_date), '2021-1-1'), visit_date) AS diff\n    FROM USerVisits\n    ORDER BY user_id\n) a\nGROUP BY user_id\n;","compare_result":"1111111111111111111111","title_slug":"biggest-window-between-visits","has_notes":false,"flag_type":1}
{"id":1296839172,"question_id":1278,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719071104,"status":10,"status_display":"Accepted","runtime":"422 ms","url":"/submissions/detail/1296839172/","is_pending":"Not Pending","title":"Product Price at a Given Date","memory":"0B","code":"# Write your MySQL query statement below\nWITH max_change_date AS (\n    SELECT product_id\n        , MAX(change_date) AS change_date\n    FROM Products p\n    WHERE change_date <= '2019-08-16'\n    GROUP BY product_id\n\n), combined AS (\n    SELECT p.product_id\n        , p.new_price AS price\n    FROM Products p\n    INNER JOIN max_change_date m ON p.product_id = m.product_id\n                                AND p.change_date = m.change_date\n\n    UNION\n\n    SELECT p.product_id\n        , 10 AS price\n    FROM Products p\n    WHERE product_id NOT IN (SELECT product_id FROM max_change_date)\n)\n\nSELECT *\nFROM combined\nORDER BY product_id","compare_result":"111111111111111","title_slug":"product-price-at-a-given-date","has_notes":false,"flag_type":1}
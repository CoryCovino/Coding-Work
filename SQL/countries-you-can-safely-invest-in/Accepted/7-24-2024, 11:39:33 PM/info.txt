{"id":1332512638,"question_id":1641,"lang":"mysql","lang_name":"MySQL","time":"4 months, 3 weeks","timestamp":1721878773,"status":10,"status_display":"Accepted","runtime":"934 ms","url":"/submissions/detail/1332512638/","is_pending":"Not Pending","title":"Countries You Can Safely Invest In","memory":"0B","code":"# Write your MySQL query statement below\n-- SELECT AVG(duration)\n-- FROM calls;\n\nWITH call_country_data AS (\n    SELECT co.name AS country_name\n        , p.id\n        , p.name\n    FROM Country co\n    INNER JOIN Person p ON co.country_code = LEFT(p.phone_number, 3)\n)\n\nSELECT country_name AS country\nFROM (\n    SELECT c.caller_id\n        , ccd.country_name\n        , c.duration\n    FROM Calls c\n    INNER JOIN call_country_data ccd ON c.caller_id = ccd.id\n\n    UNION ALL\n\n    SELECT c.callee_id\n        , ccd.country_name\n        , c.duration\n    FROM Calls c\n    INNER JOIN call_country_data ccd ON c.callee_id = ccd.id\n) a\nGROUP BY country_name\nHAVING AVG(duration) > (SELECT AVG(duration) FROM calls)\n;","compare_result":"111111111111111","title_slug":"countries-you-can-safely-invest-in","has_notes":false,"flag_type":1}
{"id":1297819202,"question_id":1654,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719151652,"status":10,"status_display":"Accepted","runtime":"794 ms","url":"/submissions/detail/1297819202/","is_pending":"Not Pending","title":"Customer Order Frequency","memory":"0B","code":"# Write your MySQL query statement below\nSELECT customer_id\n    , name\nFROM (\n    SELECT c.customer_id\n        , c.name\n        , DATE_FORMAT(o.order_date, '%Y-%m') AS order_ym\n        , SUM(o.quantity * p.price) AS total\n    FROM Customers c\n    INNER JOIN Orders o ON c.customer_id = o.customer_id\n    INNER JOIN Product p ON p.product_id = o.product_id\n    WHERE o.order_date >= '2020-06-01' \n    AND o.order_date < '2020-08-01'\n    GROUP BY c.customer_id\n        , c.name\n        , DATE_FORMAT(o.order_date, '%Y-%m')\n    HAVING SUM(o.quantity * p.price) >= 100\n) a\nGROUP BY customer_id\n    , name\nHAVING COUNT(*) > 1","compare_result":"11111111111111","title_slug":"customer-order-frequency","has_notes":false,"flag_type":1}
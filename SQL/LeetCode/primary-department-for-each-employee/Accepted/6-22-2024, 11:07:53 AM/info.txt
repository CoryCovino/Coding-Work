{"id":1296779569,"question_id":1942,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719068873,"status":10,"status_display":"Accepted","runtime":"3916 ms","url":"/submissions/detail/1296779569/","is_pending":"Not Pending","title":"Primary Department for Each Employee","memory":"0B","code":"WITH one_department AS (\n    SELECT Employee.employee_id\n        , Employee.department_id\n    FROM Employee \n    INNER JOIN (\n        SELECT employee_id\n        FROM Employee\n        GROUP BY employee_id\n        HAVING COUNT(department_id) = 1\n    ) e ON Employee.employee_id = e.employee_id\n\n), primary_department AS (\n    SELECT employee_id\n        , department_id\n    FROM Employee\n    WHERE primary_flag = 'Y'\n)\n\nSELECT *\nFROM one_department\nUNION\nSELECT *\nFROM primary_department;\n","compare_result":"11111111111111111111111","title_slug":"primary-department-for-each-employee","has_notes":false,"flag_type":1}
{"id":1299418053,"question_id":1357,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719290516,"status":10,"status_display":"Accepted","runtime":"1123 ms","url":"/submissions/detail/1299418053/","is_pending":"Not Pending","title":"Report Contiguous Dates","memory":"0B","code":"# Write your MySQL query statement below\nWITH group_data AS (\n    SELECT period_state\n        , process_date\n        , previous_date\n        , SUM(CASE WHEN previous_date >= DATE_ADD(process_date, INTERVAL -1 DAY) THEN 0 ELSE 1 END) OVER (ORDER BY process_date) AS grp\n    FROM (\n        SELECT 'succeeded' AS period_state\n            , success_date AS process_date\n            , LAG(success_date, 1) OVER (ORDER BY success_date) AS previous_date\n        FROM Succeeded\n\n        UNION ALL\n\n        SELECT 'failed' AS period_state\n            , fail_date\n            , LAG(fail_date, 1) OVER (ORDER BY fail_date) AS previous_date\n        FROM Failed\n    ) a\n)\n\nSELECT period_state\n    , start_date\n    , end_date\nFROM (\n    SELECT grp\n        , period_state\n        , MIN(process_date) AS start_date\n        , MAX(process_date) aS end_date\n    FROM group_data\n    WHERE process_date BETWEEN '2019-01-01' AND '2019-12-31'\n    GROUP BY grp, period_state\n) a\n;","compare_result":"11111111111111111111111","title_slug":"report-contiguous-dates","has_notes":false,"flag_type":1}
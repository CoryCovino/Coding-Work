{"id":1332512472,"question_id":1641,"lang":"mysql","lang_name":"MySQL","time":"4 months, 3 weeks","timestamp":1721878758,"status":10,"status_display":"Accepted","runtime":"1039 ms","url":"/submissions/detail/1332512472/","is_pending":"Not Pending","title":"Countries You Can Safely Invest In","memory":"0B","code":"SELECT name AS country\nFROM (\n    SELECT c.name\n        , COUNT(*) AS num_calls\n        , SUM(ca.duration) AS duration\n    FROM Country c\n    INNER JOIN Person p ON c.country_code = LEFT(p.phone_number, 3)\n    INNER JOIN Calls ca ON p.id = ca.caller_id\n    GROUP BY c.name\n\n    UNION ALL \n\n    SELECT c.name\n        , COUNT(*) AS num_calls\n        , SUM(ca.duration) AS duration\n    FROM Country c\n    INNER JOIN Person p ON c.country_code = LEFT(p.phone_number, 3)\n    INNER JOIN Calls ca ON p.id = ca.callee_id\n    GROUP BY c.name\n) a\nGROUP BY name\nHAVING SUM(duration) / SUM(num_calls) > (SELECT AVG(duration) AS duration FROM Calls);\n\n\n","compare_result":"111111111111111","title_slug":"countries-you-can-safely-invest-in","has_notes":false,"flag_type":1}
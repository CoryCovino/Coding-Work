{"id":1297018049,"question_id":1452,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719082845,"status":10,"status_display":"Accepted","runtime":"341 ms","url":"/submissions/detail/1297018049/","is_pending":"Not Pending","title":"Restaurant Growth","memory":"0B","code":"# Write your MySQL query statement below\nWITH daily_sales AS (\n    SELECT visited_on\n        , SUM(amount) AS amount\n    FROM Customer\n    GROUP BY visited_on\n)\n\nSELECT visited_on\n    , amount\n    , average_amount\nFROM (\n    SELECT visited_on\n        , SUM(amount) OVER (ORDER BY visited_on RANGE INTERVAL 6 DAY PRECEDING) AS amount\n        , ROUND(AVG(amount) OVER (ORDER BY visited_on RANGE INTERVAL 6 DAY PRECEDING), 2) AS average_amount\n        , COUNT(*) OVER (ORDER BY visited_on RANGE INTERVAL 6 DAY PRECEDING) AS num_days\n    FROM daily_sales\n) a\nWHERE num_days = 7\nORDER BY visited_on\n","compare_result":"11111111111111","title_slug":"restaurant-growth","has_notes":false,"flag_type":1}
{"id":1295100581,"question_id":2087,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1718930262,"status":10,"status_display":"Accepted","runtime":"854 ms","url":"/submissions/detail/1295100581/","is_pending":"Not Pending","title":"Confirmation Rate","memory":"0B","code":"# Write your MySQL query statement below\n# Number confirmed messages / total # of requested confirm messages\n# Write your MySQL query statement below\n# Number confirmed messages / total # of requested confirm messages\n\nWITH confirmed_messages AS (\n    SELECT user_id\n        , COUNT(*) AS confirms\n    FROM Confirmations\n    WHERE action = 'confirmed'\n    GROUP BY user_id\n\n), total_messages AS (\n    SELECT user_id\n        , COUNT(*) AS totals\n    FROM Confirmations\n    GROUP BY user_id\n)\n\nSELECT s.user_id\n    , CASE WHEN cm.confirms != 0\n            AND tm.totals != 0\n            THEN ROUND(cm.confirms / tm.totals, 2)\n            ELSE 0\n             END AS confirmation_rate\nFROM Signups s\nLEFT OUTER JOIN confirmed_messages cm ON s.user_id = cm.user_id\nLEFT OUTER JOIN total_messages tm ON s.user_id = tm.user_id","compare_result":"11111111111111","title_slug":"confirmation-rate","has_notes":false,"flag_type":1}
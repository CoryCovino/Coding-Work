{"id":1297400044,"question_id":1842,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719118464,"status":10,"status_display":"Accepted","runtime":"560 ms","url":"/submissions/detail/1297400044/","is_pending":"Not Pending","title":"Number of Calls Between Two Persons","memory":"0B","code":"# Write your MySQL query statement below\nSELECT person1\n    , person2\n    , SUM(call_count) AS call_count\n    , SUM(duration) AS total_duration\nFROM (\n    SELECT from_id AS person1\n        , to_id AS person2\n        , COUNT(*) AS call_count\n        , SUM(duration) AS duration\n    FROM Calls\n    WHERE from_id < to_id\n    GROUP BY from_id\n        , to_id\n\n    UNION ALL \n\n    SELECT to_id AS person1\n        , from_id AS person2\n        , COUNT(*) AS call_count\n        , SUM(duration) AS duration\n    FROM Calls\n    WHERE from_id > to_id\n    GROUP BY to_id\n        , from_id\n) a\nGROUP BY person1\n    , person2\n","compare_result":"11111111111111111","title_slug":"number-of-calls-between-two-persons","has_notes":false,"flag_type":1}
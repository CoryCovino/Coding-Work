{"id":1299328010,"question_id":1735,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719282181,"status":10,"status_display":"Accepted","runtime":"2204 ms","url":"/submissions/detail/1299328010/","is_pending":"Not Pending","title":"The Most Frequently Ordered Products for Each Customer","memory":"0B","code":"# Write your MySQL query statement below\nWITH total_purchased AS (\n    SELECT o.customer_id\n        , o.product_id\n        , COUNT(*) AS num_purchased\n    FROM Orders o\n    GROUP BY o.customer_id\n        , o.product_id\n    HAVING COUNT(*) >= 1\n\n), max_purchases AS (\n    SELECT customer_id\n        , MAX(num_purchased) AS num_purchased\n    FROM total_purchased\n    GROUP BY customer_id\n)\n\nSELECT tp.customer_id\n    , tp.product_id\n    , p.product_name\nFROM total_purchased tp\nINNER JOIN max_purchases mp ON tp.customer_id = mp.customer_id\n                           AND tp.num_purchased = mp.num_purchased\nINNER JOIN Products p ON tp.product_id = p.product_id\nORDER BY tp.customer_id, tp.product_id","compare_result":"111111111111111111111111111111111","title_slug":"the-most-frequently-ordered-products-for-each-customer","has_notes":false,"flag_type":1}
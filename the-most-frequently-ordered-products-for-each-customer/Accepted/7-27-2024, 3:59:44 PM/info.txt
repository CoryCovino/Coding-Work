{"id":1335477564,"question_id":1735,"lang":"mysql","lang_name":"MySQL","time":"4 months, 2 weeks","timestamp":1722110384,"status":10,"status_display":"Accepted","runtime":"2327 ms","url":"/submissions/detail/1335477564/","is_pending":"Not Pending","title":"The Most Frequently Ordered Products for Each Customer","memory":"0B","code":"WITH cust_orders AS (\n    SELECT customer_id\n        , product_id\n        , COUNT(*) AS num_orders\n    FROM Orders\n    GROUP BY customer_id\n        , product_id\n)\n\nSELECT a.customer_id\n    , a.product_id\n    , p.product_name\nFROM (\n    SELECT *\n        , DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY num_orders DESC) AS order_rank\n    FROM cust_orders\n) a\nINNER JOIN Products p ON a.product_id = p.product_id\nWHERE order_rank = 1","compare_result":"111111111111111111111111111111111","title_slug":"the-most-frequently-ordered-products-for-each-customer","has_notes":false,"flag_type":1}
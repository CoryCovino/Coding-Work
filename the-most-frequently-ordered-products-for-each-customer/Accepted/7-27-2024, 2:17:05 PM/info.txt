{"id":1335390960,"question_id":1735,"lang":"mysql","lang_name":"MySQL","time":"4 months, 3 weeks","timestamp":1722104225,"status":10,"status_display":"Accepted","runtime":"2146 ms","url":"/submissions/detail/1335390960/","is_pending":"Not Pending","title":"The Most Frequently Ordered Products for Each Customer","memory":"0B","code":"SELECT b.customer_id\n    , b.product_id\n    , p.product_name\nFROM (\n    SELECT customer_id\n        , product_id\n        , num_orders\n        , DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY num_orders DESC) AS c_rank\n    FROM (\n        SELECT customer_id\n            , product_id\n            , COUNT(*) AS num_orders\n        FROM Orders o\n        GROUP BY customer_id\n            , product_id\n    ) a\n) b\nINNER JOIN Products p ON b.product_id = p.product_id\nWHERE b.c_rank = 1\nORDER BY b.product_id","compare_result":"111111111111111111111111111111111","title_slug":"the-most-frequently-ordered-products-for-each-customer","has_notes":false,"flag_type":1}
{"id":1310540757,"question_id":608,"lang":"mysql","lang_name":"MySQL","time":"5 months, 1 week","timestamp":1720189501,"status":10,"status_display":"Accepted","runtime":"582 ms","url":"/submissions/detail/1310540757/","is_pending":"Not Pending","title":"Tree Node","memory":"0B","code":"# Write your MySQL query statement below\nWITH root_node AS (\n    SELECT id\n    FROM Tree\n    WHERE p_id IS NULL\n    \n), leaf_node AS (\n    SELECT id\n    FROM Tree t\n    WHERE id NOT IN (SELECT p_id FROM Tree WHERE p_id IS NOT NULL)\n      AND t.p_id IS NOT NULL\n\n), inner_node AS (\n    SELECT DISTINCT t.id\n    FROM Tree t\n    WHERE id NOT IN (\n        SELECT id FROM leaf_node\n        UNION\n        SELECT id FROM root_node\n    )\n)\n\nSELECT id\n    , type\nFROM (\n    SELECT id, 'Inner' AS type\n    FROM inner_node\n\n    UNION\n\n    SELECT id, 'Root'\n    FROM root_node\n\n    UNION\n\n    SELECT id, 'Leaf'\n    FROM leaf_node\n\n) a\nORDER BY id;\n\n","compare_result":"11111111111111111111","title_slug":"tree-node","has_notes":false,"flag_type":1}
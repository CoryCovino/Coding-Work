{"id":1333573215,"question_id":608,"lang":"mysql","lang_name":"MySQL","time":"4 months, 3 weeks","timestamp":1721953868,"status":10,"status_display":"Accepted","runtime":"420 ms","url":"/submissions/detail/1333573215/","is_pending":"Not Pending","title":"Tree Node","memory":"0B","code":"# Write your MySQL query statement below\nSELECT id\n    , 'Root' AS type\nFROM Tree\nWHERE p_id IS NULL\n\nUNION\n\nSELECT t.id\n    , 'Inner'\nFROM Tree t\nINNER JOIN Tree i ON t.id = i.p_id\nWHERE t.p_id IS NOT NULL\n\nUNION\n\nSELECT t.id\n    , 'Leaf'\nFROM Tree t\nLEFT OUTER JOIN Tree l ON t.id = l.p_id\nWHERE t.p_id IS NOT NULL\n  AND l.p_id IS NULL\n\n-- WITH root_node AS (\n--     SELECT id\n--     FROM Tree\n--     WHERE p_id IS NULL\n    \n-- ), leaf_node AS (\n--     SELECT id\n--     FROM Tree t\n--     WHERE id NOT IN (SELECT p_id FROM Tree WHERE p_id IS NOT NULL)\n--       AND t.p_id IS NOT NULL\n\n-- ), inner_node AS (\n--     SELECT DISTINCT t.id\n--     FROM Tree t\n--     WHERE id NOT IN (\n--         SELECT id FROM leaf_node\n--         UNION\n--         SELECT id FROM root_node\n--     )\n-- )\n\n-- SELECT id\n--     , type\n-- FROM (\n--     SELECT id, 'Inner' AS type\n--     FROM inner_node\n\n--     UNION\n\n--     SELECT id, 'Root'\n--     FROM root_node\n\n--     UNION\n\n--     SELECT id, 'Leaf'\n--     FROM leaf_node\n\n-- ) a\n-- ORDER BY id;\n\n","compare_result":"11111111111111111111","title_slug":"tree-node","has_notes":false,"flag_type":1}
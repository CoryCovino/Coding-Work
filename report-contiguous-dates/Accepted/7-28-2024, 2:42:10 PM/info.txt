{"id":1336556704,"question_id":1357,"lang":"mysql","lang_name":"MySQL","time":"4 months, 2 weeks","timestamp":1722192130,"status":10,"status_display":"Accepted","runtime":"1181 ms","url":"/submissions/detail/1336556704/","is_pending":"Not Pending","title":"Report Contiguous Dates","memory":"0B","code":"WITH outputs AS (\n    SELECT c_date\n        , period_state\n        , SUM(CASE WHEN prev_date >= DATE_ADD(c_date, INTERVAL -1 day) THEN 0 ELSE 1 END) OVER (ORDER BY c_date) AS seq\n    FROM (\n        SELECT 'failed' AS period_state\n            , fail_date AS c_date\n            , LAG(fail_date, 1) OVER (ORDER BY fail_date) AS prev_date\n        FROM Failed\n\n        UNION ALL\n\n        SELECT 'succeeded' AS period_state\n            , success_date AS c_date\n            , LAG(success_date, 1) OVER (ORDER BY success_date) AS prev_date\n        FROM Succeeded\n    ) a\n)\n\nSELECT period_state\n    , MIN(c_date) AS start_date\n    , MAX(c_date) AS end_date\nFROM outputs\nWHERE c_date BETWEEN '2019-01-01' AND '2019-12-31'\nGROUP BY period_state, seq\n-- ), s AS (\n--     SELECT c_date\n--         , SUM(CASE WHEN prev_date >= DATE_ADD(c_date, INTERVAL -1 day) THEN 0 ELSE 1 END) OVER (ORDER BY c_date) AS seq\n--     FROM (\n--         SELECT success_date AS c_date\n--             , LAG(success_date, 1) OVER (ORDER BY success_date) AS prev_date\n--         FROM Succeeded\n--         WHERE success_date >= '2019-01-01'\n--     ) a\n-- )\n\n-- SELECT period_state\n--     , start_date\n--     , end_date\n-- FROM (\n--     SELECT 'failed' AS period_state\n--         , MIN(c_date) AS start_date\n--         , MAX(c_date) AS end_date\n--     FROM fails\n--     GROUP BY seq\n\n--     UNION ALL \n\n--     SELECT 'succeeded' AS period_state\n--         , MIN(c_date) AS start_date\n--         , MAX(c_date) AS end_date\n--     FROM s\n--     GROUP BY seq\n-- ) a\n-- ORDER BY start_date","compare_result":"11111111111111111111111","title_slug":"report-contiguous-dates","has_notes":false,"flag_type":1}
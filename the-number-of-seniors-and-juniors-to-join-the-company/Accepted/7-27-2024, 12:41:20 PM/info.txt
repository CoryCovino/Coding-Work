{"id":1335290964,"question_id":2152,"lang":"mysql","lang_name":"MySQL","time":"4 months, 3 weeks","timestamp":1722098480,"status":10,"status_display":"Accepted","runtime":"450 ms","url":"/submissions/detail/1335290964/","is_pending":"Not Pending","title":"The Number of Seniors and Juniors to Join the Company","memory":"0B","code":"# Write your MySQL query statement below\nWITH seniors AS (\n    SELECT *\n        , SUM(salary) OVER (ORDER BY salary) AS cumulative_salary\n    FROM Candidates    \n    WHERE experience = 'Senior'\n    ORDER BY salary\n\n), hired_seniors AS (\n    SELECT *\n    FROM seniors\n    WHERE cumulative_salary <= 70000\n\n), juniors AS (\n    SELECT *\n        , SUM(salary) OVER (ORDER BY salary) AS cumulative_salary\n    FROM Candidates\n    WHERE experience = 'Junior'\n    ORDER BY salary\n\n), hired_juniors AS (\n    SELECT *\n    FROM juniors\n    WHERE cumulative_salary <= (SELECT CASE WHEN COUNT(*) = 0 THEN 70000 ELSE 70000 - MAX(cumulative_salary) END FROM hired_seniors)\n)\n\nSELECT 'Senior' AS experience\n    , COUNT(*) AS accepted_candidates\nFROM hired_seniors\nUNION\nSELECT 'Junior' AS experience\n    , COUNT(*) AS accepted_candidates\nFROM hired_juniors\n\n","compare_result":"11111111111111111111","title_slug":"the-number-of-seniors-and-juniors-to-join-the-company","has_notes":false,"flag_type":1}
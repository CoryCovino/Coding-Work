{"id":1296983248,"question_id":1480,"lang":"mysql","lang_name":"MySQL","time":"5Â months, 3Â weeks","timestamp":1719080371,"status":10,"status_display":"Accepted","runtime":"1208 ms","url":"/submissions/detail/1296983248/","is_pending":"Not Pending","title":"Movie Rating","memory":"0B","code":"# Write your MySQL query statement below\nWITH user_ratings AS (\n    SELECT u.name\n    FROM Users u\n    LEFT OUTER JOIN MovieRating mr ON u.user_id = mr.user_id\n    GROUP BY u.user_id\n        , u.name\n    ORDER BY COUNT(mr.movie_id) DESC, u.name\n    LIMIT 1\n\n), feb_ratings AS (\n    SELECT m.title\n    FROM Movies m\n    LEFT OUTER JOIN MovieRating mr ON m.movie_id = mr.movie_id\n    WHERE mr.created_at >= '2020-02-01' AND mr.created_at < '2020-03-01'\n    GROUP BY m.movie_id, m.title\n    ORDER BY AVG(mr.rating) DESC, m.title\n    LIMIT 1\n)\n\n\nSELECT name AS results\nFROM user_ratings\nUNION ALL\nSELECT title\nFROM feb_ratings\n;\n","compare_result":"1111111111111111111","title_slug":"movie-rating","has_notes":false,"flag_type":1}
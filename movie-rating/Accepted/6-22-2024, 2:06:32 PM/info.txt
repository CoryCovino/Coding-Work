{"id":1296971829,"question_id":1480,"lang":"mysql","lang_name":"MySQL","time":"5Â months, 3Â weeks","timestamp":1719079592,"status":10,"status_display":"Accepted","runtime":"1368 ms","url":"/submissions/detail/1296971829/","is_pending":"Not Pending","title":"Movie Rating","memory":"0B","code":"# Write your MySQL query statement below\nWITH user_ratings AS (\n    SELECT u.user_id\n        , u.name\n        , COUNT(mr.movie_id) AS num_movies_rated\n    FROM Users u\n    LEFT OUTER JOIN MovieRating mr ON u.user_id = mr.user_id\n    GROUP BY u.user_id\n        , u.name\n\n), feb_ratings AS (\n    SELECT m.movie_id\n        , m.title\n        , AVG(mr.rating) AS average_rating\n    FROM Movies m\n    LEFT OUTER JOIN MovieRating mr ON m.movie_id = mr.movie_id\n    WHERE mr.created_at >= '2020-02-01' AND mr.created_at < '2020-03-01'\n    GROUP BY m.movie_id, m.title\n\n), user_final AS (\n    SELECT name\n    FROM user_ratings\n    ORDER BY num_movies_rated DESC, name\n    LIMIT 1\n\n), feb_final AS (\n    SELECT title\n    FROM feb_ratings\n    ORDER BY average_rating DESC, title\n    LIMIT 1\n)\n\n\nSELECT name AS results\nFROM user_final\nUNION ALL\nSELECT title\nFROM feb_final\n\n\n;\n","compare_result":"1111111111111111111","title_slug":"movie-rating","has_notes":false,"flag_type":1}
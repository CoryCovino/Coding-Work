{"id":1297023361,"question_id":602,"lang":"mysql","lang_name":"MySQL","time":"5 months, 3 weeks","timestamp":1719083262,"status":10,"status_display":"Accepted","runtime":"252 ms","url":"/submissions/detail/1297023361/","is_pending":"Not Pending","title":"Friend Requests II: Who Has the Most Friends","memory":"0B","code":"# Write your MySQL query statement below\nWITH requesters AS (\n    SELECT requester_id AS id\n        , COUNT(*) AS num\n    FROM RequestAccepted\n    GROUP BY requester_id\n\n), accepters AS (\n    SELECT accepter_id AS id\n        , COUNT(*) AS num\n    FROM RequestAccepted\n    GROUP BY accepter_id\n\n), combined AS (\n    SELECT id\n    FROM requesters\n    UNION\n    SELECT id\n    FROM accepters\n)\n\nSELECT c.id \n    , IFNULL(r.num, 0) + IFNULL(a.num, 0) AS num\nFROM combined c\nLEFT OUTER JOIN requesters r ON c.id = r.id\nLEFT OUTER JOIN accepters a ON c.id = a.id\nORDER BY IFNULL(r.num, 0) + IFNULL(a.num, 0) DESC\nLIMIT 1\n\n","compare_result":"111111111111","title_slug":"friend-requests-ii-who-has-the-most-friends","has_notes":false,"flag_type":1}